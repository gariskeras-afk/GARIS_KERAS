<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Tebak Lagu Hits SoundCloud üéß</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1c1c3a 0%, #0a0a1e 100%);
            color: #ecf0f1;
            padding: 20px;
            text-align: center;
            min-height: 100vh;
        }
        #quiz-box {
            max-width: 600px;
            margin: 30px auto;
            background-color: #2c3e50;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        h1 {
            color: #ff6b6b;
            margin-bottom: 20px;
            text-shadow: 0 0 5px rgba(255, 107, 107, 0.5);
        }
        #question-display {
            font-size: 1.2em;
            margin-bottom: 20px;
            font-weight: 600;
            background-color: #1e3040;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #ff6b6b;
        }
        #soundcloud-player-container {
            width: 100%;
            height: 100px; /* Cukup untuk player SoundCloud minimal */
            margin-bottom: 20px;
            display: none; 
            border-radius: 8px;
            overflow: hidden;
        }
        .option-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.2s;
            border: 1px solid #34495e;
            background-color: #34495e;
            color: white;
            text-align: left;
        }
        .option-button:hover:not(:disabled) {
            background-color: #4a637d;
        }
        #result-display {
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: 600;
        }
        #start-button, #next-button, #telegram-share-button {
            padding: 12px 25px;
            margin: 10px 5px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            font-size: 1em;
        }
        #start-button { background-color: #2ecc71; color: white; }
        #next-button { background-color: #3498db; color: white; display: none; }
        #telegram-share-button { background-color: #0088cc; color: white; display: none; }
    </style>
</head>
<body>
    <div id="quiz-box">
        <h1>üéß Kuis Tebak Lagu Viral (SoundCloud) üéß</h1>
        <p>Tebak lagu hits dari klip SoundCloud!</p>
        
        <div id="soundcloud-player-container">
            <iframe id="sc-widget" width="100%" height="100" scrolling="no" frameborder="no"></iframe>
        </div>
        
        <div id="question-display">Klik "Mulai Kuis" untuk memulai tantangan tebak lagu ini!</div>
        <div id="options-container"></div>
        <div id="result-display"></div>
        
        <button id="start-button">Mulai Kuis</button>
        <button id="next-button">Lanjut Pertanyaan</button>
        <button id="telegram-share-button">Bagikan Skor ke @GW_GK</button>
    </div>

    <script src="https://w.soundcloud.com/player/api.js"></script>

    <script>
        // Data Pertanyaan (Gunakan URL SoundCloud)
        // **CATATAN:** GANTI DENGAN URL TRACK PUBLIC YANG SESUAI!
        const questions = [
            {
                q: "Dengarkan klip ini. Lagu hits pop Indonesia yang rilis 2022 ini berjudul:",
                // Contoh URL track SoundCloud (Ini mungkin perlu diganti)
                trackUrl: "https://soundcloud.com/user-229237622/sial-mahalini-live-studio", 
                options: ["Komang", "Sial", "Tertawan Hati", "Hati-Hati di Jalan"],
                answer: "Sial",
                startTime: 10000, // Mulai dari 10 detik (dalam milidetik)
                duration: 5000    // Putar selama 5 detik (dalam milidetik)
            },
            {
                q: "Ini adalah salah satu 'sound' paling viral di TikTok tahun 2023. Judul lagunya adalah:",
                trackUrl: "https://soundcloud.com/user-307996535/rungkad-happy-asmara-full-audio", 
                options: ["Rungkad", "Glimpse of Us", "Asmalibrasi", "Ayam Jago"],
                answer: "Rungkad",
                startTime: 5000, 
                duration: 7000    
            }
            // Tambahkan pertanyaan lain di sini
        ];

        
        const qDisplay = document.getElementById('question-display');
        const optionsContainer = document.getElementById('options-container');
        const resultDisplay = document.getElementById('result-display');
        const startButton = document.getElementById('start-button');
        const nextButton = document.getElementById('next-button');
        const telegramButton = document.getElementById('telegram-share-button');
        const playerContainer = document.getElementById('soundcloud-player-container');
        
        let currentQuestionIndex = 0;
        let score = 0;
        let widget;
        let stopPlaybackTimeout;
        let playAgainButton;
        let isPlayerReady = false;

        // --- Fungsi API SoundCloud Widget ---

        function initSoundCloudWidget(url, callback) {
            // Muat ulang iframe dengan URL track baru
            const iframe = document.getElementById('sc-widget');
            iframe.src = `https://w.soundcloud.com/player/?url=${encodeURIComponent(url)}&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=false&visual=false&buying=false&download=false`;

            // Buat objek widget baru
            widget = SC.Widget(iframe);
            
            widget.bind(SC.Widget.Events.READY, function() {
                isPlayerReady = true;
                if (callback) callback();
            });

            // Tambahkan error handling minimal (jika widget tidak bisa dimuat)
            setTimeout(() => {
                if (!isPlayerReady && url !== questions[currentQuestionIndex].trackUrl) {
                    console.error("SoundCloud widget gagal dimuat untuk URL:", url);
                    // Panggil fungsi error untuk pindah ke soal berikutnya
                    onPlayerError(); 
                }
            }, 5000); 
        }

        // --- HANDLER ERROR PLAYER SOUNDCLOUD ---
        function onPlayerError() {
            console.error("SoundCloud Player Error: Gagal memuat atau error tak terduga.");
            resultDisplay.innerHTML = `<span style="color: #e74c3c;">‚ùå Track Soal ${currentQuestionIndex + 1} Gagal Dimuat! Otomatis Ganti Soal...</span>`;
            
            // Auto-advance ke pertanyaan berikutnya
            currentQuestionIndex++;
            
            setTimeout(() => {
                loadQuestion();
            }, 2000); 
        }

        // --- Fungsi Kontrol Pemutaran ---
        function playClue() {
            if (!widget || !isPlayerReady || currentQuestionIndex >= questions.length) return;
            
            const q = questions[currentQuestionIndex];
            clearTimeout(stopPlaybackTimeout);
            
            // Pindahkan ke titik mulai (dalam milidetik)
            widget.seekTo(q.startTime);
            
            // Mulai putar
            widget.play();

            if(playAgainButton) playAgainButton.textContent = '‚ñ∂Ô∏è Memutar...';
            
            // Atur timeout untuk menghentikan pemutaran setelah durasi klip
            stopPlaybackTimeout = setTimeout(() => {
                widget.pause();
                if(playAgainButton) playAgainButton.textContent = 'üîä Putar Ulang Klip';
            }, q.duration); 
        }

        // --- Fungsi Utama Game ---
        function startGame() {
            currentQuestionIndex = 0;
            score = 0;
            startButton.style.display = 'none';
            telegramButton.style.display = 'none';
            resultDisplay.textContent = '';
            playerContainer.style.display = 'block'; 
            
            // Inisialisasi widget dengan track pertama
            initSoundCloudWidget(questions[0].trackUrl, loadQuestion);
        }

        function loadQuestion() {
            if (currentQuestionIndex >= questions.length) {
                showFinalResult();
                return;
            }
            
            const q = questions[currentQuestionIndex];
            
            qDisplay.innerHTML = `<strong>Soal ${currentQuestionIndex + 1}:</strong> ${q.q}`;
            optionsContainer.innerHTML = '';
            nextButton.style.display = 'none';
            resultDisplay.textContent = '';
            
            // Muat track baru jika diperlukan
            if (widget && isPlayerReady && q.trackUrl !== document.getElementById('sc-widget').src.split('url=')[1].split('&')[0]) {
                 initSoundCloudWidget(q.trackUrl, playClue);
            } else {
                playClue();
            }

            // Tampilkan tombol opsi
            q.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('option-button');
                button.addEventListener('click', () => checkAnswer(button, option, q.answer));
                optionsContainer.appendChild(button);
            });
            
            // Tambahkan tombol play manual/ulang
            playAgainButton = document.createElement('button');
            playAgainButton.textContent = 'üîä Putar Ulang Klip';
            playAgainButton.style.cssText = 'padding: 10px 20px; background-color: #1abc9c; color: white; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 15px;';
            playAgainButton.addEventListener('click', playClue);
            optionsContainer.insertBefore(playAgainButton, optionsContainer.firstChild);
        }

        function checkAnswer(clickedButton, selectedOption, correctAnswer) {
            Array.from(optionsContainer.children).forEach(btn => btn.disabled = true);
            
            clearTimeout(stopPlaybackTimeout);
            if (widget) widget.pause();
            
            if (selectedOption === correctAnswer) {
                score++;
                resultDisplay.textContent = '‚úÖ Benar! Anda Peka Musik Viral.';
                clickedButton.style.backgroundColor = '#1abc9c';
            } else {
                resultDisplay.innerHTML = `‚ùå Salah! Judul yang benar adalah: **${correctAnswer}**`;
                clickedButton.style.backgroundColor = '#e74c3c';
                Array.from(optionsContainer.children).find(btn => btn.textContent === correctAnswer).style.backgroundColor = '#2ecc71';
            }
            
            nextButton.style.display = 'block';
            nextButton.textContent = currentQuestionIndex < questions.length - 1 ? 'Lanjut Pertanyaan' : 'Lihat Hasil Akhir';
        }

        function showFinalResult() {
            qDisplay.textContent = '--- KUIS SELESAI ---';
            optionsContainer.innerHTML = '';
            nextButton.style.display = 'none';
            playerContainer.style.display = 'none';
            
            let finalStatus = (score === questions.length) ? 'ü•á MUSIKOLOG VIRAL SEJATI!' : 'üéß Masih Perlu Banyak Mendengar Lagu Hits.';
            
            resultDisplay.innerHTML = `
                Total skormu: <span style="color:#ff6b6b; font-size:1.5em;">${score}</span> dari ${questions.length}.
                <br><br><span style="color:#2ecc71;">${finalStatus}</span>
            `;
            
            startButton.textContent = 'Ulangi Kuis';
            startButton.style.display = 'block';
            telegramButton.style.display = 'block';
        }

        function shareTelegram() {
            const finalStatus = (score === questions.length) ? 'MUSIKOLOG VIRAL SEJATI' : 'Perlu Banyak Mendengar Lagu Hits';
            const shareMessage = `Aku menyelesaikan Kuis Tebak Lagu Viral (SoundCloud) dengan skor ${score}/${questions.length}! Aku adalah ${finalStatus}. Coba kamu, @GW_GK!`;
            const url = `https://t.me/GW_GK?text=${encodeURIComponent(shareMessage)}`;
            window.open(url, '_blank');
        }

        // Event Listeners
        startButton.addEventListener('click', startGame);
        nextButton.addEventListener('click', () => { currentQuestionIndex++; loadQuestion(); });
        telegramButton.addEventListener('click', shareTelegram);

        optionsContainer.innerHTML = '<p style="color:#bdc3c7;">Siap diuji dengan klip musik SoundCloud? Klik Mulai!</p>';
    </script>
</body>
</html>
