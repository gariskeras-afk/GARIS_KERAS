<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Ular Klasik üêç</title>
    <style>
        /* Menggunakan font monospasi atau retro untuk nuansa klasik */
        body {
            font-family: 'Arial', monospace; 
            background-color: #2c3e50; /* Dark background */
            color: #ecf0f1;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        #game-container {
            background-color: #34495e;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            text-align: center;
            max-width: 440px;
        }
        h1 {
            color: #2ecc71; /* Hijau */
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        #score-display {
            font-size: 1.5em;
            margin-bottom: 15px;
            color: #f1c40f; /* Kuning */
            font-weight: bold;
        }
        /* Style untuk Canvas Game Board */
        #game-board {
            border: 5px solid #27ae60;
            background-color: #1abc9c; /* Hijau muda/mint */
            display: block;
        }
        .button-group {
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1em;
            transition: background-color 0.2s;
        }
        #start-button {
            background-color: #3498db; /* Biru */
            color: white;
        }
        #start-button:hover {
            background-color: #2980b9;
        }
        #telegram-share-button {
            background-color: #0088cc; /* Biru Telegram */
            color: white;
            display: none; 
        }
        /* Mobile directional buttons (untuk layar sentuh) */
        #mobile-controls {
            display: none; 
            margin-top: 20px;
        }
        .dir-button {
            width: 50px;
            height: 50px;
            background-color: #5d6d7e;
            color: white;
            font-size: 1.2em;
            margin: 5px;
        }
        /* Tampilkan kontrol mobile di layar kecil */
        @media (max-width: 600px) {
            #mobile-controls {
                display: grid;
                grid-template-areas: ". up ." "left center right" ". down .";
                grid-template-columns: 1fr 1fr 1fr;
                gap: 5px;
            }
            #up-button { grid-area: up; }
            #down-button { grid-area: down; }
            #left-button { grid-area: left; }
            #right-button { grid-area: right; }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <h1>Game Ular Klasik üêç</h1>
        <div id="score-display">Skor: 0</div>
        <canvas id="game-board" width="400" height="400"></canvas>
        <p id="message-display">Tekan MULAI atau tombol panah untuk bermain.</p>
        
        <div class="button-group">
            <button id="start-button">Mulai Game</button>
            <button id="telegram-share-button">Bagikan Skor ke @GW_GK</button>
        </div>

        <div id="mobile-controls">
            <button id="up-button" class="dir-button" data-key="up">‚Üë</button>
            <button id="left-button" class="dir-button" data-key="left">‚Üê</button>
            <button id="right-button" class="dir-button" data-key="right">‚Üí</button>
            <button id="down-button" class="dir-button" data-key="down">‚Üì</button>
        </div>
    </div>

    <script>
        // --- Setup Game ---
        const board = document.getElementById('game-board');
        const ctx = board.getContext('2d');
        const scoreDisplay = document.getElementById('score-display');
        const startButton = document.getElementById('start-button');
        const telegramButton = document.getElementById('telegram-share-button');
        const messageDisplay = document.getElementById('message-display');
        
        // Konstanta Game
        const TILE_SIZE = 20; // Ukuran setiap kotak (tile)
        const GRID_SIZE = board.width / TILE_SIZE; // 400 / 20 = 20x20 grid
        const GAME_SPEED = 100; // Kecepatan (milidetik)

        let snake, food, dx, dy, score, gameInterval, isGameActive;

        // --- Fungsi Utama Game ---
        function initializeGame() {
            snake = [{ x: 10 * TILE_SIZE, y: 10 * TILE_SIZE }]; // Posisi awal (dikalikan TILE_SIZE)
            food = generateFood();
            dx = TILE_SIZE; // Gerak ke kanan
            dy = 0;
            score = 0;
            isGameActive = true;
            scoreDisplay.textContent = 'Skor: 0';
            messageDisplay.textContent = 'Gunakan tombol panah atau tombol di bawah!';
            startButton.style.display = 'none';
            telegramButton.style.display = 'none';

            if (gameInterval) clearInterval(gameInterval);
            gameInterval = setInterval(gameLoop, GAME_SPEED);
        }

        function gameLoop() {
            if (!isGameActive) return;

            // 1. Pindah Ular
            const head = { x: snake[0].x + dx, y: snake[0].y + dy };
            snake.unshift(head); // Tambahkan kepala baru

            // 2. Cek Game Over
            if (checkCollision(head)) {
                gameOver();
                return;
            }

            // 3. Cek Makan Makanan
            if (head.x === food.x && head.y === food.y) {
                score++;
                scoreDisplay.textContent = `Skor: ${score}`;
                food = generateFood(); // Hasilkan makanan baru
            } else {
                snake.pop(); // Hapus ekor (hanya jika tidak makan)
            }

            // 4. Gambar Ulang
            drawGame();
        }

        function drawGame() {
            // Bersihkan Canvas
            ctx.fillStyle = '#1abc9c'; // Warna background board
            ctx.fillRect(0, 0, board.width, board.height);

            // Gambar Makanan (Food)
            ctx.fillStyle = '#e74c3c'; // Merah
            ctx.fillRect(food.x, food.y, TILE_SIZE, TILE_SIZE);

            // Gambar Ular (Snake)
            ctx.fillStyle = '#2ecc71'; // Hijau
            snake.forEach((segment, index) => {
                ctx.fillRect(segment.x, segment.y, TILE_SIZE, TILE_SIZE);
                // Tambahkan sedikit border untuk segmentasi
                ctx.strokeStyle = '#27ae60';
                ctx.strokeRect(segment.x, segment.y, TILE_SIZE, TILE_SIZE);
            });
        }

        function generateFood() {
            let newFood;
            do {
                newFood = {
                    x: Math.floor(Math.random() * GRID_SIZE) * TILE_SIZE,
                    y: Math.floor(Math.random() * GRID_SIZE) * TILE_SIZE
                };
            } while (snake.some(segment => segment.x === newFood.x && segment.y === newFood.y)); 
            return newFood;
        }

        function checkCollision(head) {
            // Collision dengan Tembok
            const wallCollision = head.x < 0 || head.x >= board.width || head.y < 0 || head.y >= board.height;

            // Collision dengan Diri Sendiri (Body)
            const selfCollision = snake.slice(1).some(segment => segment.x === head.x && segment.y === head.y);

            return wallCollision || selfCollision;
        }

        function gameOver() {
            isGameActive = false;
            clearInterval(gameInterval);
            messageDisplay.textContent = `GAME OVER! Skor Akhir: ${score}`;
            startButton.textContent = 'Main Lagi';
            startButton.style.display = 'block';
            telegramButton.style.display = 'block';
        }

        // --- Kontrol dan Event Listener ---
        function changeDirection(event) {
            if (!isGameActive) return;

            // Mendapatkan key dari event keyboard (keyCode) atau data-key (tombol mobile)
            const keyPressed = event.keyCode || event.target.dataset.key;

            // KeyCodes: Left=37, Up=38, Right=39, Down=40
            
            const goingUp = dy === -TILE_SIZE;
            const goingDown = dy === TILE_SIZE;
            const goingRight = dx === TILE_SIZE;
            const goingLeft = dx === -TILE_SIZE;

            switch(keyPressed) {
                case 37: // Kiri (ArrowLeft)
                case 'left':
                    if (!goingRight) { dx = -TILE_SIZE; dy = 0; }
                    break;
                case 38: // Atas (ArrowUp)
                case 'up':
                    if (!goingDown) { dx = 0; dy = -TILE_SIZE; }
                    break;
                case 39: // Kanan (ArrowRight)
                case 'right':
                    if (!goingLeft) { dx = TILE_SIZE; dy = 0; }
                    break;
                case 40: // Bawah (ArrowDown)
                case 'down':
                    if (!goingUp) { dx = 0; dy = TILE_SIZE; }
                    break;
            }
        }
        
        document.addEventListener('keydown', changeDirection);

        // Event listener untuk tombol mobile
        document.getElementById('up-button').addEventListener('click', changeDirection);
        document.getElementById('down-button').addEventListener('click', changeDirection);
        document.getElementById('left-button').addEventListener('click', changeDirection);
        document.getElementById('right-button').addEventListener('click', changeDirection);

        // Tombol Mulai
        startButton.addEventListener('click', initializeGame);

        // Tombol Telegram Share
        function shareTelegram() {
            const username = 'GW_GK';
            const shareMessage = `Aku berhasil mencapai *Skor ${score}* di Game Ular Klasik! Aku adalah Master Ular! Coba kalahkan skor aku, @GW_GK!`;
            const url = `https://t.me/${username}?text=${encodeURIComponent(shareMessage)}`;
            window.open(url, '_blank');
        }
        telegramButton.addEventListener('click', shareTelegram);

        // Inisialisasi tampilan awal
        drawGame();
        messageDisplay.textContent = 'Tekan MULAI atau panah untuk bermain.';
    </script>
</body>
</html>
